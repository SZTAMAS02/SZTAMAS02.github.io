<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>F1 2025 Vizualiz√°ci√≥</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/topojson-client@3"></script>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;600;700&display=swap');
  
  body {
    font-family: 'Rajdhani', sans-serif;
  }
  
  .fade-in {
    animation: fadeIn 0.8s ease-in;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  .stat-card {
    transition: all 0.3s ease;
  }
  
  .stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.3);
  }
  
  .glow {
    text-shadow: 0 0 10px rgba(255,255,255,0.8), 0 0 20px rgba(255,255,255,0.5);
  }
  
  .neon-border {
    border: 2px solid;
    animation: neon 2s ease-in-out infinite alternate;
  }
  
  @keyframes neon {
    from { box-shadow: 0 0 10px rgba(220, 0, 0, 0.5), 0 0 20px rgba(220, 0, 0, 0.3); }
    to { box-shadow: 0 0 20px rgba(220, 0, 0, 0.8), 0 0 40px rgba(220, 0, 0, 0.5); }
  }
  
  .gradient-bg {
    background: linear-gradient(135deg, rgba(220, 0, 0, 0.1) 0%, rgba(255, 135, 0, 0.1) 100%);
  }
  
  .chart-container {
    position: relative;
    backdrop-filter: blur(10px);
  }
</style>
</head>
<body class="min-h-screen p-6" style="background-image: url('https://www.f1-fansite.com/wp-content/uploads/2025/03/2025-Australian-Grand-Prix-Sunday-12-Aangepast.webp'); background-size: cover; background-position: center; background-attachment: fixed;">

<div class="max-w-7xl mx-auto">

  <!-- HEADER -->
  <div class="bg-white rounded-2xl shadow-2xl p-8 mb-8 fade-in neon-border" style="background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.85) 100%);">
    <div class="flex items-center justify-between">
      <div class="flex items-center gap-6">
        <img src="https://city-png.b-cdn.net/preview/preview_public/uploads/preview/hd-f1-the-official-formula-1-transparent-png-701751712229525ajvwddtfme.png" alt="F1 Logo" class="h-20 w-auto">
        <div>
          <h1 class="text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-red-600 via-orange-500 to-red-600 mb-3" style="font-family: 'Orbitron', sans-serif;">
            2025 Szezon
          </h1>
          <p class="text-2xl font-semibold text-gray-700">Teljes anal√≠zis √©s statisztik√°k</p>
        </div>
      </div>
      <div class="text-right">
        <div class="text-5xl font-black text-red-600" style="font-family: 'Orbitron', sans-serif;">2025</div>
        <div class="text-sm text-gray-600 font-semibold">FIA Formula One Championship</div>
      </div>
    </div>
  </div>

  <!-- STAT CARDS -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8 fade-in" style="animation-delay: 0.2s;">
    
    <div class="stat-card rounded-xl shadow-xl p-6 gradient-bg" style="background: linear-gradient(135deg, rgba(255, 135, 0, 0.95) 0%, rgba(255, 100, 0, 0.9) 100%);">
      <div class="text-white">
        <div class="text-sm font-semibold uppercase tracking-wider mb-2">üèÜ Bajnok</div>
        <div class="text-3xl font-black mb-1" id="champion" style="font-family: 'Orbitron', sans-serif;">-</div>
        <div class="text-xs opacity-90" id="championPoints">- pont</div>
      </div>
    </div>
    
    <div class="stat-card rounded-xl shadow-xl p-6" style="background: linear-gradient(135deg, rgba(255, 135, 0, 0.95) 0%, rgba(255, 100, 0, 0.9) 100%);">
      <div class="text-white">
        <div class="text-sm font-semibold uppercase tracking-wider mb-2">üèéÔ∏è Konstrukt≈ër Bajnok</div>
        <div class="text-3xl font-black mb-1" id="constructorChamp" style="font-family: 'Orbitron', sans-serif;">-</div>
        <div class="text-xs opacity-90" id="constructorPoints">- pont</div>
      </div>
    </div>
    
    <div class="stat-card rounded-xl shadow-xl p-6" style="background: linear-gradient(135deg, rgba(245, 245, 245, 0.95) 0%, rgba(220, 220, 220, 0.9) 100%);">
      <div class="text-gray-800">
        <div class="text-sm font-semibold uppercase tracking-wider mb-2">üéØ Versenyek</div>
        <div class="text-3xl font-black mb-1" id="totalRaces" style="font-family: 'Orbitron', sans-serif;">-</div>
        <div class="text-xs opacity-70">Futam & Sprint</div>
      </div>
    </div>
    
    <div class="stat-card rounded-xl shadow-xl p-6" style="background: linear-gradient(135deg, rgba(0, 51, 160, 0.95) 0%, rgba(0, 30, 120, 0.9) 100%);">
      <div class="text-white">
        <div class="text-sm font-semibold uppercase tracking-wider mb-2">‚ö° Legt√∂bb gy≈ëzelem</div>
        <div class="text-3xl font-black mb-1" id="mostWins" style="font-family: 'Orbitron', sans-serif;">-</div>
        <div class="text-xs opacity-90" id="mostWinsDriver">-</div>
      </div>
    </div>
    
  </div>

  <!-- LINE CHART: TOP 3 PIL√ìTA -->
  <div class="chart-container bg-white rounded-2xl shadow-2xl p-8 mb-8 fade-in" style="background-color: rgba(255, 255, 255, 0.85); animation-delay: 0.3s;">
    <div class="flex items-center justify-between mb-6">
      <h2 class="text-4xl font-black text-gray-800" style="font-family: 'Orbitron', sans-serif;">
        üìà Top 3 Pil√≥ta Trend
      </h2>
      <span class="text-sm font-semibold text-gray-600 bg-gray-100 px-4 py-2 rounded-full">Kumulat√≠v pontok</span>
    </div>
    <canvas id="pointsChart" height="120"></canvas>
  </div>

  <!-- BAR CHART: √ñSSZPONTOK -->
  <div class="chart-container bg-white rounded-2xl shadow-2xl p-8 mb-8 fade-in" style="background-color: rgba(255, 255, 255, 0.85); animation-delay: 0.4s;">
    <div class="flex items-center justify-between mb-6">
      <h2 class="text-4xl font-black text-gray-800" style="font-family: 'Orbitron', sans-serif;">
        üë§ Pil√≥ta Ranglista
      </h2>
      <span class="text-sm font-semibold text-gray-600 bg-gray-100 px-4 py-2 rounded-full">Szezon v√©gi √°ll√°s</span>
    </div>
    <canvas id="barChart" height="120"></canvas>
  </div>

  <!-- BAR CHART: KONSTRUKT≈êR√ñK -->
  <div class="chart-container bg-white rounded-2xl shadow-2xl p-8 mb-8 fade-in" style="background-color: rgba(255, 255, 255, 0.85); animation-delay: 0.5s;">
    <div class="flex items-center justify-between mb-6">
      <h2 class="text-4xl font-black text-gray-800" style="font-family: 'Orbitron', sans-serif;">
        üèéÔ∏è Konstrukt≈ër Ranglista
      </h2>
      <span class="text-sm font-semibold text-gray-600 bg-gray-100 px-4 py-2 rounded-full">Csapat √∂sszes√≠tett</span>
    </div>
    <canvas id="constructorChart" height="100"></canvas>
  </div>

  <!-- T√âRK√âP: Versenyhelysz√≠nek -->
  <div class="chart-container bg-white rounded-2xl shadow-2xl p-8 mb-8 fade-in" style="background-color: rgba(255, 255, 255, 0.85); animation-delay: 0.6s;">
    <div class="flex items-center justify-between mb-6">
      <h2 class="text-4xl font-black text-gray-800" style="font-family: 'Orbitron', sans-serif;">
        üó∫Ô∏è Vil√°gt√©rk√©p
      </h2>
      <span class="text-sm font-semibold text-gray-600 bg-gray-100 px-4 py-2 rounded-full">24 versenyhelysz√≠n</span>
    </div>
    <div id="mapContainer" style="width: 100%; height: 600px; position: relative;">
      <svg id="worldMap" width="100%" height="100%"></svg>
    </div>
  </div>

  <!-- FOOTER -->
  <div class="text-center text-white py-6 fade-in" style="animation-delay: 0.7s;">
    <p class="text-sm font-semibold" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.8);">
      Data Source: F1 2025 Official Results | Created with ‚ù§Ô∏è for F1 Fans
    </p>
  </div>

</div>

<script>
const teamColors = {
  "McLaren": "#FF8700",
  "Red Bull Racing": "#0033A0",
  "Ferrari": "#DC0000",
  "Mercedes": "#00D2BE",
  "Williams": "#005AFF",
  "Aston Martin": "#006F62",
  "Kick Sauber": "#00FF00",
  "Racing Bulls": "#6699FF",
  "Haas F1 Team": "#B6BABD",
  "Haas": "#B6BABD",
  "Alpine": "#0090FF"
};

// CSV bet√∂lt√©se √©s feldolgoz√°sa
async function loadData() {
  try {
    const response = await fetch('data.csv');
    const csvText = await response.text();
    
    const lines = csvText.trim().split('\n');
    const raceData = {};
    const driverPoints = {};
    const driverTeams = {};
    const driverWins = {};
    
    lines.forEach(line => {
      const [race, position, driver, team, points] = line.split(',');
      
      if (!raceData[race]) {
        raceData[race] = [];
      }
      raceData[race].push({ driver, team, points: parseInt(points) });
      
      if (!driverPoints[driver]) {
        driverPoints[driver] = [];
        driverTeams[driver] = team;
        driverWins[driver] = 0;
      }
      
      if (parseInt(points) === 25) {
        driverWins[driver]++;
      }
    });
    
    const races = Object.keys(raceData);
    
    const allDrivers = Object.keys(driverPoints);
    allDrivers.forEach(driver => {
      races.forEach(race => {
        const raceResult = raceData[race].find(r => r.driver === driver);
        driverPoints[driver].push(raceResult ? raceResult.points : 0);
      });
    });
    
    const totalPoints = {};
    allDrivers.forEach(driver => {
      totalPoints[driver] = driverPoints[driver].reduce((sum, points) => sum + points, 0);
    });
    
    const top3Drivers = allDrivers
      .sort((a, b) => totalPoints[b] - totalPoints[a])
      .slice(0, 3);
    
    // STAT CARDS friss√≠t√©se
    document.getElementById('champion').textContent = top3Drivers[0];
    document.getElementById('championPoints').textContent = totalPoints[top3Drivers[0]] + ' pont';
    
    const constructorPoints = {};
    allDrivers.forEach(driver => {
      const team = driverTeams[driver];
      if (!constructorPoints[team]) {
        constructorPoints[team] = 0;
      }
      constructorPoints[team] += totalPoints[driver];
    });
    
    const topConstructor = Object.keys(constructorPoints).sort((a, b) => constructorPoints[b] - constructorPoints[a])[0];
    document.getElementById('constructorChamp').textContent = topConstructor;
    document.getElementById('constructorPoints').textContent = constructorPoints[topConstructor] + ' pont';
    
    document.getElementById('totalRaces').textContent = races.length;
    
    const mostWinsDriver = Object.keys(driverWins).sort((a, b) => driverWins[b] - driverWins[a])[0];
    document.getElementById('mostWins').textContent = driverWins[mostWinsDriver] + ' gy≈ëzelem';
    document.getElementById('mostWinsDriver').textContent = mostWinsDriver;
    
    // Kumulat√≠v pontok
    const cumulativePoints = {};
    top3Drivers.forEach(driver => {
      cumulativePoints[driver] = [];
      let sum = 0;
      driverPoints[driver].forEach(points => {
        sum += points;
        cumulativePoints[driver].push(sum);
      });
    });
    
    // --- ELS≈ê DIAGRAM: Kumulat√≠v pontok ---
    const datasets = top3Drivers.map(driver => ({
      label: driver,
      data: cumulativePoints[driver],
      borderColor: driver === "Yuki Tsunoda" ? teamColors["Red Bull Racing"] : teamColors[driverTeams[driver]],
      backgroundColor: (driver === "Yuki Tsunoda" ? teamColors["Red Bull Racing"] : teamColors[driverTeams[driver]]) + "33",
      fill: true,
      tension: 0.4,
      borderWidth: 4,
      pointRadius: 4,
      pointHoverRadius: 8,
      pointBackgroundColor: driver === "Yuki Tsunoda" ? teamColors["Red Bull Racing"] : teamColors[driverTeams[driver]],
      pointBorderColor: '#fff',
      pointBorderWidth: 2
    }));
    
    new Chart(document.getElementById('pointsChart'), {
      type: 'line',
      data: { labels: races, datasets: datasets },
      options: {
        responsive: true,
        plugins: {
          tooltip: { 
            mode: 'index', 
            intersect: false,
            backgroundColor: 'rgba(0, 0, 0, 0.8)',
            titleFont: { size: 14, weight: 'bold' },
            bodyFont: { size: 13 },
            padding: 12,
            borderColor: '#fff',
            borderWidth: 1
          },
          legend: { 
            position: 'top', 
            labels: { 
              font: { size: 16, weight: 'bold' },
              padding: 15,
              usePointStyle: true
            } 
          }
        },
        interaction: { mode: 'nearest', axis: 'x', intersect: false },
        scales: { 
          y: { 
            title: { display: true, text: 'Kumulat√≠v pontok', font: { size: 14, weight: 'bold' } }, 
            beginAtZero: true, 
            max: 450,
            grid: { color: 'rgba(0, 0, 0, 0.05)' }
          },
          x: {
            grid: { display: false }
          }
        }
      }
    });
    
    // --- M√ÅSODIK DIAGRAM: √ñsszpontok ---
    const sortedDrivers = allDrivers.sort((a, b) => totalPoints[b] - totalPoints[a]);
    
    new Chart(document.getElementById('barChart'), {
      type: 'bar',
      data: {
        labels: sortedDrivers,
        datasets: [{
          label: '√ñsszpont',
          data: sortedDrivers.map(d => totalPoints[d]),
          backgroundColor: sortedDrivers.map(d => (d === "Yuki Tsunoda" ? teamColors["Red Bull Racing"] : teamColors[driverTeams[d]]) + 'CC'),
          borderColor: sortedDrivers.map(d => d === "Yuki Tsunoda" ? teamColors["Red Bull Racing"] : teamColors[driverTeams[d]]),
          borderWidth: 2,
          borderRadius: 8,
          hoverBackgroundColor: sortedDrivers.map(d => d === "Yuki Tsunoda" ? teamColors["Red Bull Racing"] : teamColors[driverTeams[d]])
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { display: false },
          tooltip: { 
            enabled: true,
            backgroundColor: 'rgba(0, 0, 0, 0.8)',
            padding: 12,
            borderColor: '#fff',
            borderWidth: 1
          }
        },
        scales: { 
          y: { 
            beginAtZero: true, 
            title: { display: true, text: 'Pont', font: { size: 14, weight: 'bold' } },
            grid: { color: 'rgba(0, 0, 0, 0.05)' }
          },
          x: {
            grid: { display: false }
          }
        }
      }
    });
    
    // --- KONSTRUKT≈êR DIAGRAM ---
    const sortedTeams = Object.keys(constructorPoints).sort((a, b) => constructorPoints[b] - constructorPoints[a]);
    
    new Chart(document.getElementById('constructorChart'), {
      type: 'bar',
      data: {
        labels: sortedTeams,
        datasets: [{
          label: 'Konstrukt≈ër pontok',
          data: sortedTeams.map(team => constructorPoints[team]),
          backgroundColor: sortedTeams.map(team => teamColors[team] + 'CC'),
          borderColor: sortedTeams.map(team => teamColors[team]),
          borderWidth: 3,
          borderRadius: 8,
          hoverBackgroundColor: sortedTeams.map(team => teamColors[team])
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { display: false },
          tooltip: { 
            enabled: true,
            backgroundColor: 'rgba(0, 0, 0, 0.8)',
            padding: 12,
            borderColor: '#fff',
            borderWidth: 1
          }
        },
        scales: { 
          y: { 
            beginAtZero: true, 
            title: { display: true, text: 'Pont', font: { size: 14, weight: 'bold' } },
            grid: { color: 'rgba(0, 0, 0, 0.05)' }
          },
          x: {
            grid: { display: false }
          }
        }
      }
    });
    
    // --- HARMADIK DIAGRAM: Vil√°gt√©rk√©p ---
    const raceLocations = {
      'Australia': { coords: [133.88, -25.27], city: 'Melbourne' },
      'China': { coords: [121.47, 31.23], city: 'Shanghai' },
      'Japan': { coords: [136.53, 34.84], city: 'Suzuka' },
      'Bahrain': { coords: [50.51, 26.03], city: 'Sakhir' },
      'Saudi Arabia': { coords: [39.10, 21.63], city: 'Jeddah' },
      'Miami': { coords: [-80.24, 25.96], city: 'Miami' },
      'Emilia Romagna': { coords: [11.71, 44.34], city: 'Imola' },
      'Monaco': { coords: [7.42, 43.73], city: 'Monte Carlo' },
      'Spain': { coords: [2.26, 41.57], city: 'Barcelona' },
      'Canada': { coords: [-73.52, 45.50], city: 'Montreal' },
      'Austria': { coords: [14.76, 47.22], city: 'Spielberg' },
      'Great Britain': { coords: [-1.02, 52.07], city: 'Silverstone' },
      'Belgium': { coords: [5.97, 50.44], city: 'Spa-Francorchamps' },
      'Hungary': { coords: [19.25, 47.58], city: 'Budapest' },
      'Netherlands': { coords: [4.54, 52.39], city: 'Zandvoort' },
      'Italy': { coords: [9.29, 45.62], city: 'Monza' },
      'Azerbaijan': { coords: [49.85, 40.37], city: 'Baku' },
      'Singapore': { coords: [103.86, 1.29], city: 'Marina Bay' },
      'United States': { coords: [-97.64, 30.13], city: 'Austin' },
      'Mexico': { coords: [-99.09, 19.40], city: 'Mexico City' },
      'Brazil': { coords: [-46.70, -23.70], city: 'S√£o Paulo' },
      'Las Vegas': { coords: [-115.17, 36.11], city: 'Las Vegas' },
      'Qatar': { coords: [51.45, 25.49], city: 'Lusail' },
      'Abu Dhabi': { coords: [54.60, 24.47], city: 'Yas Island' }
    };

    const raceWinners = {};
    races.forEach(race => {
      const raceName = race.replace(' Sprint', '');
      if (!raceWinners[raceName]) {
        const winner = raceData[race].find(r => parseInt(r.points) === 25 || parseInt(r.points) === 8);
        if (winner) {
          raceWinners[raceName] = winner.driver;
        }
      }
    });

    const width = document.getElementById('mapContainer').offsetWidth;
    const height = 600;

    const svg = d3.select('#worldMap')
      .attr('width', width)
      .attr('height', height);

    const projection = d3.geoMercator()
      .scale(width / 6.5)
      .translate([width / 2, height / 1.5]);

    const path = d3.geoPath().projection(projection);

    d3.json('https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json').then(world => {
      const countries = topojson.feature(world, world.objects.countries);

      svg.append('g')
        .selectAll('path')
        .data(countries.features)
        .enter()
        .append('path')
        .attr('d', path)
        .attr('fill', '#2a2a2a')
        .attr('stroke', '#000000')
        .attr('stroke-width', 0.5);

      Object.keys(raceLocations).forEach(race => {
        if (raceWinners[race]) {
          const location = raceLocations[race];
          const coords = projection(location.coords);

          const circle = svg.append('circle')
            .attr('cx', coords[0])
            .attr('cy', coords[1])
            .attr('r', 8)
            .attr('fill', '#DC0000')
            .attr('stroke', '#ffffff')
            .attr('stroke-width', 2)
            .style('cursor', 'pointer')
            .style('filter', 'drop-shadow(0 0 8px rgba(220, 0, 0, 0.8))')
            .on('mouseover', function(event) {
              d3.select(this)
                .transition()
                .duration(200)
                .attr('r', 14)
                .style('filter', 'drop-shadow(0 0 15px rgba(220, 0, 0, 1))');
              
              tooltip.style('opacity', 1)
                .html(`<strong style="font-size: 16px;">${race}</strong><br/><span style="color: #FFD700;">üìç ${location.city}</span><br/><span style="color: #00FF00;">üèÜ ${raceWinners[race]}</span>`)
                .style('left', (event.pageX + 15) + 'px')
                .style('top', (event.pageY - 15) + 'px');
            })
            .on('mouseout', function() {
              d3.select(this)
                .transition()
                .duration(200)
                .attr('r', 8)
                .style('filter', 'drop-shadow(0 0 8px rgba(220, 0, 0, 0.8))');
              
              tooltip.style('opacity', 0);
            });
        }
      });

      const tooltip = d3.select('body')
        .append('div')
        .style('position', 'absolute')
        .style('background', 'linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(40, 40, 40, 0.95))')
        .style('color', 'white')
        .style('padding', '15px 20px')
        .style('border-radius', '12px')
        .style('font-size', '14px')
        .style('font-weight', '600')
        .style('pointer-events', 'none')
        .style('opacity', 0)
        .style('transition', 'opacity 0.3s')
        .style('z-index', '1000')
        .style('border', '2px solid rgba(220, 0, 0, 0.5)')
        .style('box-shadow', '0 8px 32px rgba(0, 0, 0, 0.5)');
    });
    
  } catch (error) {
    console.error('Hiba a CSV bet√∂lt√©se sor√°n:', error);
  }
}

loadData();
</script>
</body>
</html>
